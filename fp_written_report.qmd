---
title: "SDS 220 Final Project - Written Report"
author: "Evelyn Dinh & Sophie Biderman"
format: pdf
editor: source
bibliography: citation.bib
csl: apa.csl
---

```{r}
#| include: false
#| echo: false
#| message: false
#| warning: false

library(tidyverse)
library(janitor)
library(readr)

sleep_productivity_stress <- read_csv("sleep_productivity_stress.csv") |>
  clean_names() |>
  rename("early_bird_or_night_owl" = "are_you_more_of_an_early_bird_or_a_night_owl",
         "weekday_sleep_average" = "how_long_do_you_sleep_during_weekdays_on_average" ,
         "weekday_productivity_level" = "how_productive_are_you_during_weekdays_on_average_rate_your_productivity_on_the_following_scales_1_not_productive_2_4_somewhat_productive_5_very_productive",
         "weekday_stress_level" = "on_average_how_stressed_do_you_feel_during_weekdays_rate_your_stress_on_the_following_scales_1_not_stressed_2_4_somewhat_stressed_5_very_stressed")
  
sleep_productivity <- sleep_productivity_stress |>  
  select(weekday_sleep_average,
         weekday_productivity_level)

sleep_stress <- sleep_productivity_stress |>
  select(weekday_sleep_average,
         weekday_stress_level)
```

## Introduction


## Exploratory Data Analysis

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep
#| fig-cap: "Weekday Sleep Duration"
#| echo: false

sleep_productivity_stress |>
  mutate(weekday_sleep_average = fct_relevel(weekday_sleep_average, 
            "Less than 5 hours", "5-7 hours", "More than 7 hours")) |>
  ggplot(aes(x = weekday_sleep_average,
             fill = weekday_sleep_average)) +
  geom_bar() +
  labs(
    title = "Weekday Sleep Duration of College Students",
    subtitle = "A Survey of Sleep Duration of College Students",
    caption = "Source: Self-Collected Survey",
    x = "Weekday Sleep Duration",
    y = "Count",
    fill = "Weekday Sleep Duration"
  )
```

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: productivity
#| fig-cap: "Weekday Productivity Level"
#| echo: false

sleep_productivity_stress |>
  ggplot(aes(x = weekday_productivity_level,
             fill = weekday_productivity_level)) +
  geom_bar() +
  theme(
    axis.text = element_text(size = 7.5)
  ) +
  labs(
    title = "Weekday Productivity Level of College Students",
    subtitle = "A Survey of Productivity of College Students",
    caption = "Source: Self-Collected Survey",
    x = "Weekday Productivity Level",
    y = "Count",
    fill = "Weekday Productivity Level"
  )
```

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: stress
#| fig-cap: "Weekday Stress Level"
#| echo: false

sleep_productivity_stress |>
  ggplot(aes(x = weekday_stress_level,
             fill = weekday_stress_level)) +
  geom_bar() +
  labs(
    title = "Weekday Stress Level of College Students",
    subtitle = "A Survey of Stress of College Students",
    caption = "Source: Self-Collected Survey",
    x = "Weekday Stress Level",
    y = "Count",
    fill = "Weekday Stress Level"
  )
```
## Results

### Sleep Duration vs. Productivity Level

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_productivity
#| tbl-cap: "Sleep Duration vs. Productivity Level"
#| echo: false

sleep_productivity <- table(sleep_productivity)
knitr::kable(sleep_productivity)
```

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_productivity
#| fig-cap: "Sleep Duration vs. Productivity Level"
#| echo: false

sleep_productivity_stress |>
  ggplot(aes(x = weekday_productivity_level,
             fill = weekday_sleep_average)) +
  geom_bar() +
  theme(
    axis.text = element_text(size = 7.5)
  ) +
  labs(
    title = "Sleep Duration vs. Productivity Level",
    subtitle = "A Survey of Sleep Duration vs. Productivity Level of College Students",
    caption = "Source: Self-Collected Survey",
    x = "Weekday Productivity Level",
    y = "Count",
    fill = "Weekday Sleep Duration"
  )
```

#### Hypotheses

- $H_0$: Sleep duration and productivity level are independent.
- $H_A$: Sleep duration and productivity level are related.

#### Conditions

1. **Independence**

2. **Large Sample**

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_productivity
#| tbl-cap: "Sleep Duration vs. Productivity Level Expected Counts"
#| echo: false

chi_square_test <- chisq.test(sleep_productivity)
expected_counts <- chi_square_test$expected
knitr::kable(round(expected_counts, 2))
```

#### Chi-Square Testing

```{r}
#| echo: false
#| message: false
#| warning: false

print(chi_square_test)
```

### Sleep Duration vs. Stress Level

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_stress
#| tbl-cap: "Sleep Duration vs. Stress Level"
#| echo: false

sleep_stress <- table(sleep_stress)
knitr::kable(sleep_stress)
```

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_stress
#| fig-cap: "Sleep Duration vs. Stress Level"
#| echo: false

sleep_productivity_stress |>
  ggplot(aes(x = weekday_stress_level,
             fill = weekday_sleep_average)) +
  geom_bar() +
  labs(
    title = "Sleep Duration vs. Stress Level",
    subtitle = "A Survey of Sleep Duration vs. Stress Level of College Students",
    caption = "Source: Self-Collected Survey",
    x = "Weekday Stress Level",
    y = "Count",
    fill = "Weekday Sleep Duration"
  )
```

#### Hypotheses

- $H_0$: Sleep duration and stress level are independent.
- $H_A$: Sleep duration and stress level are related.

#### Conditions

1. **Independence**

2. **Large Sample**

```{r}
#| echo: false
#| message: false
#| warning: false

#| label: sleep_productivity
#| tbl-cap: "Sleep Duration vs. Stress Level Expected Counts"
#| echo: false

chi_square_test_2 <- chisq.test(sleep_stress)
expected_counts_2 <- chi_square_test_2$expected
knitr::kable(round(expected_counts_2, 2))
```

#### Chi-Square Testing

```{r}
#| echo: false
#| message: false
#| warning: false

print(chi_square_test_2)
```

## Discussion

## Appendix

## Bibliography
